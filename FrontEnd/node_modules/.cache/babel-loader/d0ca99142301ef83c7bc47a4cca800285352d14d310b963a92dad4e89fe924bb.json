{"ast":null,"code":"import _objectSpread from\"c:/Users/Chiavetta/Desktop/programacion-3-2025-chiavetta-Ramires102/FrontEnd/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{authService}from'../services/api';import{authUtils}from'../utils/auth';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=_ref=>{let{onLoginSuccess,onSwitchToRegister}=_ref;const[formData,setFormData]=useState({email:'',contrasena:''});const[message,setMessage]=useState(null);const[isLoading,setIsLoading]=useState(false);const[previousAccounts,setPreviousAccounts]=useState([]);useEffect(()=>{const prev=authUtils.getPreviousAccounts();setPreviousAccounts(prev);const lastEmail=authUtils.getLastEmail();if(lastEmail){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{email:lastEmail}));}},[]);const handleInputChange=e=>{const{name,value}=e.target;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));};const handleSubmit=async e=>{e.preventDefault();setIsLoading(true);setMessage({text:'Iniciando sesión...',type:'info'});try{const response=await authService.login(formData);// Store authentication data\nauthUtils.setToken(response.token);authUtils.setUserId(response.usuario.ID.toString());authUtils.setUsername(response.usuario.nombre);authUtils.setLastEmail(formData.email);// Update previous accounts\nconst prevAccounts=authUtils.getPreviousAccounts();if(!prevAccounts.includes(formData.email)){prevAccounts.push(formData.email);authUtils.setPreviousAccounts(prevAccounts);setPreviousAccounts(prevAccounts);}setMessage({text:'¡Login exitoso! Redirigiendo al dashboard...',type:'success'});setTimeout(()=>{onLoginSuccess();},800);}catch(error){var _error$response,_error$response$data;setMessage({text:((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.detail)||'Error al iniciar sesión',type:'error'});}finally{setIsLoading(false);}};const selectPreviousAccount=email=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{email}));};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Iniciar Sesi\\xF3n\"}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"message \".concat(message.type),children:message.text}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"Correo Electr\\xF3nico\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",name:\"email\",value:formData.email,onChange:handleInputChange,required:true,placeholder:\"tu@email.com\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"contrasena\",children:\"Contrase\\xF1a\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"contrasena\",name:\"contrasena\",value:formData.contrasena,onChange:handleInputChange,required:true,placeholder:\"\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\\u2022\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn\",disabled:isLoading,children:isLoading?'Iniciando sesión...':'Iniciar Sesión'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",onClick:onSwitchToRegister,children:\"Crear una cuenta\"})]}),previousAccounts.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'30px'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'15px',color:'#555',marginBottom:'8px'},children:\"Cuentas previas:\"}),previousAccounts.map((email,index)=>/*#__PURE__*/_jsx(\"div\",{style:{background:'#f5f5f5',padding:'8px 12px',borderRadius:'6px',marginBottom:'6px',cursor:'pointer'},onClick:()=>selectPreviousAccount(email),children:email},index))]})]});};export default Login;","map":{"version":3,"names":["React","useState","useEffect","authService","authUtils","jsx","_jsx","jsxs","_jsxs","Login","_ref","onLoginSuccess","onSwitchToRegister","formData","setFormData","email","contrasena","message","setMessage","isLoading","setIsLoading","previousAccounts","setPreviousAccounts","prev","getPreviousAccounts","lastEmail","getLastEmail","_objectSpread","handleInputChange","e","name","value","target","handleSubmit","preventDefault","text","type","response","login","setToken","token","setUserId","usuario","ID","toString","setUsername","nombre","setLastEmail","prevAccounts","includes","push","setTimeout","error","_error$response","_error$response$data","data","detail","selectPreviousAccount","className","children","concat","onSubmit","htmlFor","id","onChange","required","placeholder","disabled","onClick","length","style","marginTop","fontSize","color","marginBottom","map","index","background","padding","borderRadius","cursor"],"sources":["c:/Users/Chiavetta/Desktop/programacion-3-2025-chiavetta-Ramires102/FrontEnd/src/components/Login.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { authService } from '../services/api';\r\nimport { authUtils } from '../utils/auth';\r\nimport { LoginRequest } from '../types';\r\n\r\ninterface LoginProps {\r\n  onLoginSuccess: () => void;\r\n  onSwitchToRegister: () => void;\r\n}\r\n\r\nconst Login: React.FC<LoginProps> = ({ onLoginSuccess, onSwitchToRegister }) => {\r\n  const [formData, setFormData] = useState<LoginRequest>({\r\n    email: '',\r\n    contrasena: '',\r\n  });\r\n  const [message, setMessage] = useState<{ text: string; type: 'success' | 'error' | 'info' } | null>(null);\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [previousAccounts, setPreviousAccounts] = useState<string[]>([]);\r\n\r\n  useEffect(() => {\r\n    const prev = authUtils.getPreviousAccounts();\r\n    setPreviousAccounts(prev);\r\n    const lastEmail = authUtils.getLastEmail();\r\n    if (lastEmail) {\r\n      setFormData(prev => ({ ...prev, email: lastEmail }));\r\n    }\r\n  }, []);\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const { name, value } = e.target;\r\n    setFormData(prev => ({ ...prev, [name]: value }));\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n    setMessage({ text: 'Iniciando sesión...', type: 'info' });\r\n\r\n    try {\r\n      const response = await authService.login(formData);\r\n\r\n      // Store authentication data\r\n      authUtils.setToken(response.token);\r\n      authUtils.setUserId(response.usuario.ID.toString());\r\n      authUtils.setUsername(response.usuario.nombre);\r\n      authUtils.setLastEmail(formData.email);\r\n\r\n      // Update previous accounts\r\n      const prevAccounts = authUtils.getPreviousAccounts();\r\n      if (!prevAccounts.includes(formData.email)) {\r\n        prevAccounts.push(formData.email);\r\n        authUtils.setPreviousAccounts(prevAccounts);\r\n        setPreviousAccounts(prevAccounts);\r\n      }\r\n\r\n      setMessage({ text: '¡Login exitoso! Redirigiendo al dashboard...', type: 'success' });\r\n      setTimeout(() => {\r\n        onLoginSuccess();\r\n      }, 800);\r\n    } catch (error: any) {\r\n      setMessage({\r\n        text: error.response?.data?.detail || 'Error al iniciar sesión',\r\n        type: 'error'\r\n      });\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const selectPreviousAccount = (email: string) => {\r\n    setFormData(prev => ({ ...prev, email }));\r\n  };\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <h2>Iniciar Sesión</h2>\r\n      {message && (\r\n        <div className={`message ${message.type}`}>\r\n          {message.text}\r\n        </div>\r\n      )}\r\n\r\n      <form onSubmit={handleSubmit}>\r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"email\">Correo Electrónico</label>\r\n          <input\r\n            type=\"email\"\r\n            id=\"email\"\r\n            name=\"email\"\r\n            value={formData.email}\r\n            onChange={handleInputChange}\r\n            required\r\n            placeholder=\"tu@email.com\"\r\n          />\r\n        </div>\r\n\r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"contrasena\">Contraseña</label>\r\n          <input\r\n            type=\"password\"\r\n            id=\"contrasena\"\r\n            name=\"contrasena\"\r\n            value={formData.contrasena}\r\n            onChange={handleInputChange}\r\n            required\r\n            placeholder=\"••••••••\"\r\n          />\r\n        </div>\r\n\r\n        <button type=\"submit\" className=\"btn\" disabled={isLoading}>\r\n          {isLoading ? 'Iniciando sesión...' : 'Iniciar Sesión'}\r\n        </button>\r\n        <button type=\"button\" className=\"btn btn-secondary\" onClick={onSwitchToRegister}>\r\n          Crear una cuenta\r\n        </button>\r\n      </form>\r\n\r\n      {previousAccounts.length > 0 && (\r\n        <div style={{ marginTop: '30px' }}>\r\n          <div style={{ fontSize: '15px', color: '#555', marginBottom: '8px' }}>Cuentas previas:</div>\r\n          {previousAccounts.map((email, index) => (\r\n            <div\r\n              key={index}\r\n              style={{\r\n                background: '#f5f5f5',\r\n                padding: '8px 12px',\r\n                borderRadius: '6px',\r\n                marginBottom: '6px',\r\n                cursor: 'pointer'\r\n              }}\r\n              onClick={() => selectPreviousAccount(email)}\r\n            >\r\n              {email}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}